select member, facility, cost from (
  			select mems.firstname || ' ' || mems.surname as member, facs.name as facility,
  				case 
  					when mems.memid = 0 then
  						books.slots*facs.guestcost
  						else
  							books.slots*facs.membercost
  				end as cost
  			from
  				cd.members mems
  				inner join cd.bookings books
  				on mems.memid = books.memid
  				inner join cd.facilities facs
  				on facs.facid = books.facid
 			where
				books.starttime >= '2012-09-14' and
				books.starttime < '2012-09-15'
  ) as bookings
  where cost > 30
  order by cost desc;